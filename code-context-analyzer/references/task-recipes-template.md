# ä»»åŠ¡é…æ–¹

> ä»…å½“æ‰§è¡Œæ„å»ºã€æµ‹è¯•ã€éƒ¨ç½²ç­‰ä»»åŠ¡æ—¶åŠ è½½æ­¤æ–‡ä»¶

## å¸¸ç”¨å‘½ä»¤

| å‘½ä»¤ | ç”¨é€” |
| ---- | ---- |
| `npm run dev` | å¯åŠ¨å¼€å‘æœåŠ¡å™¨ |
| `npm run build` | æ„å»ºç”Ÿäº§ç‰ˆæœ¬ |
| `npm run test` | è¿è¡Œæ‰€æœ‰æµ‹è¯• |
| `npm run test:watch` | ç›‘å¬æ¨¡å¼æµ‹è¯• |
| `npm run lint` | ä»£ç æ£€æŸ¥ |
| `npm run db:migrate` | æ‰§è¡Œæ•°æ®åº“è¿ç§» |
| `npm run db:seed` | å¡«å……æµ‹è¯•æ•°æ® |
| `npm run deploy:staging` | éƒ¨ç½²åˆ°é¢„å‘å¸ƒ |

## ç¯å¢ƒé…ç½®

| ç¯å¢ƒ | é…ç½®æ–‡ä»¶ | ç‰¹ç‚¹ |
| ---- | -------- | ---- |
| local | `.env.local` | æœ¬åœ°å¼€å‘ï¼Œmock æœåŠ¡ |
| dev | `.env.dev` | è”è°ƒç¯å¢ƒ |
| staging | `.env.staging` | é¢„å‘å¸ƒï¼Œç”Ÿäº§æ•°æ®å‰¯æœ¬ |
| prod | `.env.prod` | ğŸ”´ ç”Ÿäº§ç¯å¢ƒ |

**åˆ‡æ¢**: `NODE_ENV=staging npm run build`

## ä»»åŠ¡æµç¨‹

### æ·»åŠ æ–° API

```
routes/{resource}.ts      â†’ è·¯ç”±å®šä¹‰
services/{resource}.ts    â†’ ä¸šåŠ¡é€»è¾‘
repositories/{resource}.ts â†’ æ•°æ®è®¿é—®
types/{resource}.ts       â†’ ç±»å‹å®šä¹‰
tests/api/{resource}.test.ts â†’ æµ‹è¯•
```

### æ·»åŠ æ–°è¡¨

```
1. npm run db:migration:create -- add_xxx_table
2. ç¼–å†™ DDLï¼ˆğŸ”´ åªèƒ½è¿½åŠ ï¼Œç¦æ­¢æ”¹å·²æœ‰ migrationï¼‰
3. npm run db:migrate
4. åˆ›å»º model + repository
5. æ›´æ–° database-schema.md
```

### ä¿®å¤ Bug

```
1. å¤ç° â†’ ç¼–å†™å¤±è´¥æµ‹è¯•
2. å®šä½ â†’ æŸ¥æ—¥å¿—/è°ƒè¯•
3. ä¿®å¤ â†’ æœ€å°æ”¹åŠ¨
4. éªŒè¯ â†’ æµ‹è¯•é€šè¿‡
5. æ£€æŸ¥ â†’ å½±å“èŒƒå›´ï¼ˆæŸ¥ impact-analysis.mdï¼‰
```

## æµ‹è¯•ç­–ç•¥

| å±‚çº§ | è¦†ç›–ç›®æ ‡ | å‘½ä»¤ |
| ---- | -------- | ---- |
| å•å…ƒ | å·¥å…·å‡½æ•°ã€çº¯é€»è¾‘ | `npm run test:unit` |
| é›†æˆ | APIã€æ•°æ®åº“äº¤äº’ | `npm run test:integration` |
| E2E | å…³é”®ç”¨æˆ·æµç¨‹ | `npm run test:e2e` |

**å¿…é¡»æµ‹è¯•**: æ ¸å¿ƒä¸šåŠ¡æµç¨‹ã€è¾¹ç•Œæ¡ä»¶ã€é”™è¯¯å¤„ç†ã€æƒé™æ ¡éªŒ

## éƒ¨ç½²æµç¨‹

```
æœ¬åœ°æµ‹è¯• â†’ PR â†’ Review â†’ åˆå¹¶ main â†’ è‡ªåŠ¨éƒ¨ç½² staging â†’ éªŒè¯ â†’ æ‰‹åŠ¨è§¦å‘ prod
```

**å›æ»š**: `npm run deploy:rollback -- v1.2.3`

## é‡æ„æ£€æŸ¥

```
1. ç¡®ä¿æœ‰æµ‹è¯•è¦†ç›–ï¼ˆæ— æµ‹è¯•å…ˆè¡¥ï¼‰
2. å°æ­¥ä¿®æ”¹ï¼Œé¢‘ç¹æäº¤
3. æ¯æ­¥è¿è¡Œæµ‹è¯•
4. æ›´æ–°ç›¸å…³æ–‡æ¡£
```
